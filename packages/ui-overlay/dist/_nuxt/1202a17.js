(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1021:function(t,n,e){"use strict";e.r(n);e(310),e(11),e(43),e(311),e(312),e(313),e(314),e(315),e(316),e(317),e(318),e(319),e(320),e(321),e(322),e(323),e(38),e(26),e(70),e(234),e(72);var o=e(170),r=e(3),d=e(471),f=e(307),l={};l.props={opts:Object},l.setup=function(t,n){var e=new Map,l=t,m={emotesSize:3,animation:"fadeup",animationTime:1e3,maxEmotesPerMessage:5,maxRotation:2250,offsetX:200},c=Object(r.ref)(Object(f.pick)(Object(f.defaults)(Object(f.omitBy)(l.opts,f.isNull),m),Object.keys(m))),v=Object(r.ref)([]);Object(r.onMounted)((function(){console.log("====== EMOTES ======"),Object(o.getSocket)("/services/twitch",!0).on("emote",(function(t){return O(t)})),setInterval((function(){h(),w()}),100)}));var w=function(){Object(f.every)(v.value,(function(t){return t.animation.finished}))&&(v.value=[])},h=function(){for(var t=function(i,t){!v.value[i].animation.running&&Date.now()-v.value[i].trigger>0&&(v.value[i].show=!0,Object(r.nextTick)((function(){v.value[i].animation.running=!0})))},i=0,n=v.value.length;i<n;i++)t(i)},y=function(t){return"fadeup"===t||"fadezoom"===t?Object(f.random)(window.innerHeight-200)+100:"facebook"===t?window.innerHeight-20:"fall"===t?0:window.innerHeight/2},O=function(t){var n,o,r=null!==(n=e.get(t.id))&&void 0!==n?n:0;-1===r||r>=c.value.maxEmotesPerMessage?-1!==r&&(e.set(t.id,-1),setTimeout((function(){e.delete(t.id)}),5e3)):(e.set(t.id,r+1),v.value.push({id:Math.random().toString(36).substr(2,9)+"-"+Math.random().toString(36).substr(2,9),trigger:Date.now()+Object(f.random)(500),show:!1,animation:{type:c.value.animation,time:c.value.animationTime,running:!1,finished:!1},position:{left:(o=c.value.animation,"fadeup"===o||"fadezoom"===o||"fall"===o?Object(f.random)(window.innerWidth-200)+100:"facebook"===o?Object(f.random)(200)+window.innerWidth-350:window.innerWidth/2),top:y(c.value.animation)},url:t.url[c.value.emotesSize]}))};return{emotes:v,doAnimation:function(t,n){var e=t.id,o=v.value.find((function(t){return t.id===e}));if("fadeup"===o.animation.type)d.default.to(t,{top:o.position.top-150,opacity:0,duration:v.value.find((function(t){return t.id===e})).animation.time/1e3});else if("facebook"===o.animation.type)d.default.to(t,{top:o.position.top-Object(f.random)(window.innerHeight/4,window.innerHeight/1.2),left:Object(f.random)(o.position.left-100,Math.min(o.position.left+100,window.innerWidth-100)),opacity:0,duration:v.value.find((function(t){return t.id===e})).animation.time/1e3});else if("fadezoom"===o.animation.type)d.default.to(t,{scale:2,opacity:0,duration:v.value.find((function(t){return t.id===e})).animation.time/1e3});else if("fall"===o.animation.type){t.style.opacity="0";var r=Math.random()*c.value.maxRotation;d.default.to(t,{top:window.innerHeight-t.offsetHeight/1.4,ease:"bounce",duration:v.value.find((function(t){return t.id===e})).animation.time/1e3}),d.default.to(t,{opacity:1,duration:1}),d.default.to(t,{rotate:"".concat(Math.random()<=.5?-r:r,"deg"),duration:v.value.find((function(t){return t.id===e})).animation.time/1e3});var l=c.value.offsetX-Math.random()*(2*c.value.offsetX);d.default.to(t,{left:"".concat(o.position.left+l),ease:"power3",duration:v.value.find((function(t){return t.id===e})).animation.time/1e3})}else d.default.to(t,{opacity:0,duration:v.value.find((function(t){return t.id===e})).animation.time/1e3});d.default.to(t,{opacity:0,duration:1,delay:v.value.find((function(t){return t.id===e})).animation.time/1e3-1,onComplete:function(){v.value.find((function(t){return t.id===e})).animation.finished=!0,n()}})}}};var m=l,c=e(95),component=Object(c.a)(m,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"emotes"}},t._l(t.emotes,(function(n){return e("transition",{key:n.id,attrs:{name:n.animation.type,duration:n.animation.time,css:!1},on:{leave:t.doAnimation}},[n.animation.finished?t._e():e("img",{directives:[{name:"show",rawName:"v-show",value:n.show&&!n.animation.running,expression:"e.show && !e.animation.running"}],staticStyle:{position:"absolute"},style:{left:n.position.left+"px",top:n.position.top+"px"},attrs:{id:n.id,src:n.url}})])})),1)}),[],!1,null,null,null);n.default=component.exports}}]);