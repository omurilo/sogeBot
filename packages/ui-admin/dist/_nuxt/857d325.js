(window.webpackJsonp=window.webpackJsonp||[]).push([[173,112],{1098:function(e,t,n){var content=n(1262);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(20).default)("6f7e26b7",content,!0,{sourceMap:!1})},1261:function(e,t,n){"use strict";n(1098)},1262:function(e,t,n){var r=n(19)((function(i){return i[1]}));r.push([e.i,".dense .v-list-item[data-v-95577872]{min-height:25px!important}",""]),r.locals={},e.exports=r},1464:function(e,t,n){"use strict";n.r(t);n(1),n(40),n(51),n(11),n(52),n(55),n(12),n(14),n(13),n(15);var r=n(26),l=n(2),o=n(35),c=(n(81),n(31),n(8),n(4),n(25),n(69),n(119),n(28),n(70),n(33),n(103),n(37),n(39),n(73),n(34),n(47),n(494),n(62),n(1097)),v=n(5),d=n(771),f=n(21),m=n(49),_=n.n(m),h=n(54),y=n(988),O=n.n(y),j=n(80),k=n(141);function w(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function x(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?w(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):w(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,l=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw l}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var D={audio:"mdi-file-music",video:"mdi-file-video",image:"mdi-file-image"},C=Object(v.c)({setup:function(){var e=Object(v.i)(""),t=Object(v.i)([]),n=Object(v.i)([]),l=Object(v.i)([]),m=Object(v.i)([]),y=Object(v.i)(!1);Object(v.p)(y,(function(e){e||(m.value=[])}));var w=Object(v.i)(0),S=Object(v.i)(0),C=Object(v.i)(!1),B=Object(v.i)(!1),F=Object(v.i)(!1),V=Object(v.i)(!1),P=Object(v.i)(0),M=Object(v.i)(0),R=Object(v.i)(0),A=Object(v.i)("");Object(v.p)([F,V],(function(e){var t,n;e&&(A.value=null!==(t=null===(n=U.value)||void 0===n?void 0:n.folder)&&void 0!==t?t:"/")}));var E=Object(v.i)({loading:d.ButtonStates.progress,uploading:d.ButtonStates.idle,folder:d.ButtonStates.idle,delete:d.ButtonStates.idle});Object(v.f)((function(){$()}));var L=function e(n){var r=function(e){var n,r=[],l=I(t.value.map((function(e){return e.folder.split("/").filter(Boolean)})));try{for(l.s();!(n=l.n()).done;){for(var o=n.value,c=o.length>0,i=0;i<e.length;i++)try{o[i]!==e[i]&&(c=!1)}catch(e){c=!1;break}c&&o[e.length]&&r.push(o[e.length])}}catch(e){l.e(e)}finally{l.f()}return Object(h.uniq)(r).sort()}(n=n||[]);return{id:0===n.length?"Gallery":n[n.length-1],name:0===n.length?"Gallery":n[n.length-1],children:[].concat(Object(o.a)(r.map((function(t){var r;return e([].concat(Object(o.a)(null!==(r=n)&&void 0!==r?r:[]),[t]))}))),Object(o.a)(t.value.filter((function(e){var t=0===(n=n||[]).join("/").length?"/":n.join("/");return t="/"!==t[0]?"/"+t:t,("/"!==e.folder[0]?"/"+e.folder:e.folder)===t})).map((function(e){return{id:e.id,name:e.name,file:e.type}}))))}},T=Object(v.a)((function(){return[L()]}));Object(v.p)(n,(function(){P.value=0,M.value=0,R.value=0}),{deep:!0}),Object(v.p)(w,(function(e){S.value===e?E.value.uploading=d.ButtonStates.idle:E.value.uploading=d.ButtonStates.progress}));var $=function(){Object(f.getSocket)("/overlays/gallery").emit("generic::getAll",(function(e,n){if(e)Object(j.a)(e);else{console.debug("Loaded",n),t.value.length=0;var r,o=I(n);try{for(o.s();!(r=o.n()).done;){var c=r.value;t.value.push(x(x({},c),{},{folder:z(c.folder)}))}}catch(e){o.e(e)}finally{o.f()}E.value.loading=d.ButtonStates.success,l.value=0===l.value.length?["Gallery"]:l.value}}))},U=Object(v.a)((function(){if(n.value.length>0){var e=t.value.find((function(e){return e.id===n.value[0]}));if(e)return x(x({},e),{},{width:P.value,height:M.value,duration:R.value,link:location.origin+"/gallery/"+e.id})}return null}));Object(v.p)(U,(function(e){if(e)if(e.type.includes("image")){var img=new Image;img.addEventListener("load",(function(){P.value=this.naturalWidth,M.value=this.naturalHeight})),img.src=e.link}else if(e.type.includes("audio")){var audio=new Audio;audio.addEventListener("loadedmetadata",(function(){R.value=this.duration})),audio.src=e.link}else if(e.type.includes("video")){var video=document.createElement("video");video.addEventListener("loadedmetadata",(function(){P.value=this.videoWidth,M.value=this.videoHeight,R.value=this.duration})),video.src=e.link}}));var Y=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(r){var l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E.value.delete=d.ButtonStates.progress,l=null!==r?[r]:m.value,e.next=4,Promise.all(l.map((function(e){return new Promise((function(n,r){console.log("Deleting",e),Object(f.getSocket)("/overlays/gallery").emit("generic::deleteById",e,(function(l){l&&r(Object(j.a)(l)),t.value=t.value.filter((function(t){return t.id!==e})),n(!0)}))}))})));case 4:$(),k.a.$emit("snack","success","Data removed."),m.value=[],n.value=[],E.value.delete=d.ButtonStates.idle,C.value=!1,B.value=!1;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(path){return"."===(path=Object(c.normalize)(path))[0]&&(path=path.replace(".","")),"/"!==path[0]&&(path="/"+path),path=path.replace(/\/+$/,"")},G=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E.value.folder=d.ButtonStates.progress,A.value=z(A.value),r=null!==t?[t]:m.value,e.next=5,Promise.all(r.map((function(e){return new Promise((function(t,n){Object(f.getSocket)("/overlays/gallery").emit("generic::setById",{id:e,item:{folder:A.value}},(function(e){e&&n(Object(j.a)(e)),t(!0)}))}))})));case 5:$(),k.a.$emit("snack","success","Data updated."),m.value=[],n.value=[],E.value.folder=d.ButtonStates.idle,F.value=!1,V.value=!1;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{search:e,state:E,items:t,selected:m,filesChange:function(e){if(e){E.value.uploading=d.ButtonStates.progress,S.value=e.length,w.value=0;for(var n=function(i,n){var l=new FileReader;l.onload=Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,c,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=O()(),o=String(l.result).match(/.{1,500000}/g)){n.next=4;break}return n.abrupt("return");case 4:c=regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){console.debug("upload::".concat(e[i].name,"::chunk::").concat(n)),Object(f.getSocket)("/overlays/gallery").emit("gallery::upload",[e[i].name,{id:r,b64data:o[n]}],(function(r){if(r)return Object(j.a)(r);console.debug("done::".concat(e[i].name,"::chunk::").concat(n)),t(!0)}))}));case 2:case"end":return t.stop()}}),t)})),v=0;case 6:if(!(v<o.length)){n.next=11;break}return n.delegateYield(c(v),"t0",8);case 8:v++,n.next=6;break;case 11:w.value++,Object(f.getSocket)("/overlays/gallery").emit("generic::getOne",r,(function(e,n){e?Object(j.a)(e):n&&(console.debug("Uploaded",n),t.value.push(n))}));case 13:case"end":return n.stop()}}),n)}))),l.readAsDataURL(e[i])},i=0,l=e.length;i<l;i++)n(i)}},active:n,activeItem:U,duration:R,newFolder:A,changeFolder:G,opened:l,selectable:y,deleteDialog:C,deleteMultiDialog:B,folderDialog:F,folderMultiDialog:V,deleteItem:Y,isUploadingNum:S,uploadedFiles:w,translate:_.a,files:D,itemsTree:T,ButtonStates:d.ButtonStates}}}),B=C,F=(n(1261),n(45)),V=n(44),P=n.n(V),M=n(48),R=n(43),A=n(27),E=n(379),L=n(362),T=n(30),$=n(385),U=n(18),Y=n(143),z=n(134),G=n(140),H=n(1168),component=Object(F.a)(B,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{class:{"pa-4":!e.$vuetify.breakpoint.mobile},attrs:{fluid:""}},[n("v-sheet",{staticClass:"my-2 pb-2 mt-0",attrs:{flat:"",color:"dark"}},[n("v-row",{staticClass:"px-2",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"pr-2",attrs:{cols:"auto","align-self":"center"}},[n("v-btn",{attrs:{icon:"",color:e.selectable?"primary":"secondary"},on:{click:function(t){e.selectable=!e.selectable}}},[n("v-icon",[e._v("\n            mdi-checkbox-multiple-marked-outline\n          ")])],1)],1),e._v(" "),n("v-col",[n("v-text-field",{staticClass:"pr-2",attrs:{label:"Search",multiple:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),n("v-col",{attrs:{cols:"auto","align-self":"center"}},[e.selected.length>0?[n("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,l=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mr-1",attrs:{color:"primary"}},"v-btn",l,!1),r),[e._v("\n                Change folder of "+e._s(e.selected.length)+" Item(s)\n              ")])]}}],null,!1,3629272131),model:{value:e.folderMultiDialog,callback:function(t){e.folderMultiDialog=t},expression:"folderMultiDialog"}},[e._v(" "),n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v("Change folder of "+e._s(e.selected.length)+" Item(s)")])]),e._v(" "),n("v-card-text",[n("v-text-field",{attrs:{"single-line":"",label:"Folder",counter:""},model:{value:e.newFolder,callback:function(t){e.newFolder=t},expression:"newFolder"}})],1),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{text:""},on:{click:function(t){e.folderMultiDialog=!1}}},[e._v("\n                  Cancel\n                ")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",text:"",loading:e.state.folder===e.ButtonStates.progress},on:{click:function(t){return e.changeFolder(null)}}},[e._v("\n                  Yes, change\n                ")])],1)],1)],1)]:e._e()],2),e._v(" "),n("v-col",{attrs:{cols:"auto","align-self":"center"}},[e.selected.length>0?[n("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,l=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mr-1",attrs:{color:"error"}},"v-btn",l,!1),r),[e._v("\n                Delete "+e._s(e.selected.length)+" Item(s)\n              ")])]}}],null,!1,3366045047),model:{value:e.deleteMultiDialog,callback:function(t){e.deleteMultiDialog=t},expression:"deleteMultiDialog"}},[e._v(" "),n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v("Delete "+e._s(e.selected.length)+" Item(s)?")])]),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{text:""},on:{click:function(t){e.deleteMultiDialog=!1}}},[e._v("\n                  Cancel\n                ")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"error",text:"",loading:e.state.loading===e.ButtonStates.progress},on:{click:function(t){return e.deleteItem(null)}}},[e._v("\n                  Yes, Delete\n                ")])],1)],1)],1)]:e._e()],2),e._v(" "),n("v-col",{attrs:{cols:"auto","align-self":"center"}},[n("form",{attrs:{enctype:"multipart/form-data",novalidate:""}},[n("v-btn",{attrs:{color:"primary",loading:e.state.uploading===e.ButtonStates.progress},on:{click:function(t){return e.$refs.uploadFileInput.click()}}},[e._v("\n            Upload item\n          ")]),e._v(" "),n("input",{ref:"uploadFileInput",staticClass:"d-none input-file",attrs:{type:"file",disabled:e.state.uploading===e.ButtonStates.progress,multiple:"",accept:"image/*, video/mp4, video/webm, audio/*"},on:{change:function(t){return e.filesChange(t.target.files)}}})],1)])],1)],1),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12",md:"7"}},[n("v-card",{attrs:{loading:e.state.loading!==e.ButtonStates.success}},[n("v-card-text",[n("v-treeview",{key:e.state.loading+"treeview",attrs:{"selection-type":"leaf",selectable:e.selectable,items:e.itemsTree,transition:"",active:e.active,activatable:"",open:e.opened,search:e.search,dense:"","item-key":"id","open-on-click":""},on:{"update:active":function(t){e.active=t},"update:open":function(t){e.opened=t}},scopedSlots:e._u([{key:"prepend",fn:function(t){var r=t.item,l=t.open;return[r.file?n("v-icon",[e._v("\n                "+e._s(e.files[r.file.split("/")[0]])+"\n              ")]):n("v-icon",[e._v("\n                "+e._s(l?"mdi-folder-open":"mdi-folder")+"\n              ")])]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1)],1),e._v(" "),e.activeItem?n("v-col",{key:e.activeItem.id,attrs:{cols:"12",md:"5"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("\n          "+e._s(e.activeItem.name)+"\n        ")]),e._v(" "),e.activeItem?n("v-card-text",[e.activeItem.type.includes("audio")?n("v-icon",{staticClass:"text-center d-block ma-auto",attrs:{size:"125"}},[e._v("\n            mdi-file-music\n          ")]):e.activeItem.type.includes("image")?n("v-img",{attrs:{src:e.activeItem.link}}):e._e(),e._v(" "),e.activeItem.type.includes("video")?n("video",{staticStyle:{width:"100%"},attrs:{controls:""}},[n("source",{attrs:{type:e.activeItem.type,src:e.activeItem.link}})]):e._e(),e._v(" "),e.activeItem.type.includes("audio")?n("audio",{staticStyle:{width:"100%"},attrs:{controls:""}},[n("source",{attrs:{type:e.activeItem.type,src:e.activeItem.link}})]):e._e(),e._v(" "),n("v-list",{staticClass:"dense",attrs:{dense:""}},[n("v-list-item",[n("strong",[e._v("Filename:")]),e._v(" "+e._s(e.activeItem.name)+"\n            ")]),e._v(" "),n("v-list-item",[n("strong",[e._v("Filetype:")]),e._v(" "+e._s(e.activeItem.type)+"\n            ")]),e._v(" "),e.activeItem.type.includes("image")||e.activeItem.type.includes("video")?n("v-list-item",[n("strong",[e._v("Dimensions:")]),e._v(" \n              "),0===e.activeItem.width||0===e.activeItem.height?n("v-progress-circular",{attrs:{indeterminate:"",size:"20"}}):n("span",[e._v(e._s(e.activeItem.width)+"x"+e._s(e.activeItem.height))])],1):e._e(),e._v(" "),e.activeItem.type.includes("audio")||e.activeItem.type.includes("video")?n("v-list-item",[n("strong",[e._v("Duration:")]),e._v(" \n              "),0===e.activeItem.duration?n("v-progress-circular",{attrs:{indeterminate:"",size:"20"}}):n("span",[e._v(e._s(e.activeItem.duration)+"s")])],1):e._e(),e._v(" "),n("v-list-item",[n("strong",[e._v("Link:")]),e._v(" \n              "),n("a",{attrs:{href:e.activeItem.link}},[e._v(e._s(e.activeItem.link))])])],1),e._v(" "),n("v-card-actions",[n("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,l=t.attrs;return[n("v-btn",e._g(e._b({attrs:{color:"error",text:""}},"v-btn",l,!1),r),[e._v("\n                  Delete\n                ")])]}}],null,!1,1006407246),model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[e._v(" "),n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("\n                  Do you want to delete this item?\n                ")]),e._v(" "),n("v-divider"),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{text:""},on:{click:function(t){e.deleteDialog=!1}}},[e._v("\n                    Cancel\n                  ")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"error",text:"",loading:e.state.loading===e.ButtonStates.progress},on:{click:function(t){return e.deleteItem(e.activeItem.id)}}},[e._v("\n                    Yes, delete\n                  ")])],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,l=t.attrs;return[n("v-btn",e._g(e._b({attrs:{color:"primary",text:""}},"v-btn",l,!1),r),[e._v("\n                  Change folder\n                ")])]}}],null,!1,80499283),model:{value:e.folderDialog,callback:function(t){e.folderDialog=t},expression:"folderDialog"}},[e._v(" "),n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("\n                  Change folder\n                ")]),e._v(" "),n("v-divider"),e._v(" "),n("v-card-text",[n("v-text-field",{attrs:{"single-line":"",label:"Folder",counter:""},model:{value:e.newFolder,callback:function(t){e.newFolder=t},expression:"newFolder"}})],1),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{text:""},on:{click:function(t){e.folderDialog=!1}}},[e._v("\n                    Cancel\n                  ")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",text:"",loading:e.state.folder===e.ButtonStates.progress},on:{click:function(t){return e.changeFolder(e.activeItem.id)}}},[e._v("\n                    Yes, change it\n                  ")])],1)],1)],1)],1)],1):e._e()],1)],1):e._e()],1)],1)}),[],!1,null,"95577872",null);t.default=component.exports;P()(component,{VBtn:M.a,VCard:R.a,VCardActions:R.b,VCardText:R.d,VCardTitle:R.e,VCol:A.a,VContainer:A.b,VDialog:E.a,VDivider:L.a,VIcon:T.a,VImg:$.a,VList:U.a,VListItem:U.c,VProgressCircular:Y.a,VRow:A.d,VSheet:z.a,VSpacer:A.e,VTextField:G.a,VTreeview:H.a})},771:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonStates=void 0,t.ButtonStates={idle:0,progress:1,success:2,fail:3}}}]);