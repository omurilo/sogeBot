(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1146:function(e,t,n){var content=n(1409);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(20).default)("526aea3e",content,!0,{sourceMap:!1})},1408:function(e,t,n){"use strict";n(1146)},1409:function(e,t,n){var r=n(19)((function(i){return i[1]}));r.push([e.i,".playlist-item-trim .v-input__append-outer .v-input,.playlist-item-trim .v-input__prepend-outer .v-input{padding-top:0;margin-top:0;min-width:100px}",""]),r.locals={},e.exports=r},1564:function(e,t,n){"use strict";n.r(t);var r=n(1),l=n(357),o=(n(70),n(8),n(4),n(46),n(12),n(28),n(24),n(40),n(33),n(51),n(37),n(25),n(11),n(52),n(55),n(39),n(461)),c=n(21),d=n(49),m=n.n(d),v=n(779),f=n.n(v),h=n(804),y=n.n(h),x=n(3),S=n(141);function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,l=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw l}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}x.default.use(o.a,{plyr:{}});var O=Object(r.h)({filters:{formatTime:function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),s=e%60;return[t,n>9?n:t?"0"+n:n||"0",s>9?s:"0"+s].filter((function(a){return a})).join(":")}},props:{value:Object,rules:Object,permissionItems:Array,tagsItems:Array},setup:function(e,t){var menu=Object(r.J)(!1),n=Object(r.J)(y()(e.value)),o=Object(r.J)(!0),form=Object(r.J)(null),d=Object(r.J)(!1),v=Object(r.J)([n.value.startTime,n.value.endTime]);Object(r.Y)(v,(function(e){n.value.startTime!==e[0]&&(n.value.startTime=e[0]),n.value.endTime!==e[1]&&(n.value.endTime=e[1])})),Object(r.Y)([function(){return n.value.startTime},function(){return n.value.endTime}],(function(e){v.value=[e[0],e[1]]}));var h=Object(r.J)(null),x=Object(r.b)((function(){return h.value?h.value.player:null})),T=Object(r.J)(0),O=function t(){o.value=!0,form.value?(form.value.resetValidation(),n.value=y()(e.value)):setTimeout((function(){t()}),100)};Object(r.Y)(menu,(function(e){e&&O()}));var j=Object(r.b)((function(){return Object(l.a)(e.tagsItems).slice(1)})),_=function(e){console.log(e.detail.plyr.currentTime),T.value=Math.round(e.detail.plyr.currentTime)};Object(r.A)((function(){w()}));var w=function(){return new Promise((function(e){!function t(){x.value&&x.value.ready?(x.value.off("timeupdate"),x.value.on("timeupdate",(function(e){return _(e)})),x.value.off("seeked"),x.value.on("seeked",(function(e){return _(e)})),x.value.off("seeking"),x.value.on("seeking",(function(e){return _(e)})),e()):setTimeout((function(){return t()}),1e3)}()}))};return{menu:menu,item:n,save:function(){if(form.value.validate()){for(var r=0,l=Object.keys(e.rules);r<l.length;r++){var o,m=l[r],v=I(e.rules[m]);try{for(v.s();!(o=v.n()).done;){var f=(0,o.value)(n.value[m]);if(!0!==f)return void S.a.$emit("snack","red","[".concat(m,"] - ").concat(f))}}catch(e){v.e(e)}finally{v.f()}}d.value=!0,n.value.volume=Number(n.value.volume),n.value.startTime=Number(n.value.startTime),n.value.endTime=Number(n.value.endTime),Object(c.getSocket)("/systems/songs").emit("songs::save",n.value,(function(e){if(e)return console.error(e),void(d.value=!1);d.value=!1,menu.value=!1,t.emit("save")}))}},translate:m.a,capitalize:f.a,valid:o,saving:d,form:form,tagsItemsWithoutNull:j,videoTimeUpdated:_,range:v,startSegment:function(){n.value.startTime=T.value},endSegment:function(){n.value.endTime=T.value},playerRef:h,ensureGeneralTag:function(e){0===e.tags.length&&(e.tags=["general"])}}},head:function(){return{link:[{rel:"stylesheet",href:"https://unpkg.com/vue-plyr/dist/vue-plyr.css"}]}}}),j=(n(1408),n(45)),_=n(44),w=n.n(_),k=n(48),V=n(390),C=n(43),D=n(27),A=n(778),$=n(379),P=n(377),E=n(30),J=n(18),M=n(465),N=n(140),component=Object(j.a)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{persistent:"","max-width":"1000",scrollable:"",fullscreen:e.$vuetify.breakpoint.mobile},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,l=t.attrs;return[void 0!==e.item.videoId?n("v-btn",e._g(e._b({staticClass:"primary-hover",attrs:{icon:""}},"v-btn",l,!1),r),[n("v-icon",[e._v("\n          mdi-pencil\n        ")])],1):n("v-btn",e._g(e._b({attrs:{color:"primary"}},"v-btn",l,!1),r),[e._v("\n        New item\n      ")])]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),n("v-card",{staticClass:"pt-3",attrs:{outlined:""}},[n("v-card-text",[n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-row",[n("v-col",{attrs:{md:"5",cols:"12"}},[n("vue-plyr",{ref:"playerRef"},[n("div",{attrs:{"data-plyr-provider":"youtube","data-plyr-embed-id":e.item.videoId}})])],1),e._v(" "),n("v-col",[n("v-row",{attrs:{dense:""}},[n("v-col",{attrs:{cols:"auto","align-self":"center"}},[n("v-btn-toggle",{model:{value:e.item.forceVolume,callback:function(t){e.$set(e.item,"forceVolume",t)},expression:"item.forceVolume"}},[n("v-btn",{attrs:{value:!1,small:"",outlined:""}},[e._v("\n                      "+e._s(e.translate("systems.songs.calculated"))+"\n                    ")]),e._v(" "),n("v-btn",{attrs:{value:!0,small:"",outlined:""}},[e._v("\n                      "+e._s(e.translate("systems.songs.set_manually"))+"\n                    ")])],1)],1),e._v(" "),n("v-col",[n("v-text-field",{attrs:{label:e.translate("systems.songs.settings.volume"),min:"0",max:"100",type:"number",rules:e.rules.volume,disabled:!e.item.forceVolume},model:{value:e.item.volume,callback:function(t){e.$set(e.item,"volume",e._n(t))},expression:"item.volume"}})],1)],1),e._v(" "),n("v-row",{staticClass:"mt-0"},[n("v-col",[n("v-combobox",{attrs:{label:e.translate("tags"),multiple:"","return-object":!1,items:e.tagsItemsWithoutNull},on:{input:function(t){return e.ensureGeneralTag(e.item)}},scopedSlots:e._u([{key:"no-data",fn:function(){return[n("v-list-item",[n("span",{staticClass:"subheading"},[e._v("Add new tag")])])]},proxy:!0}]),model:{value:e.item.tags,callback:function(t){e.$set(e.item,"tags",t)},expression:"item.tags"}})],1)],1)],1)],1),e._v(" "),n("v-row",{staticClass:"mt-0"},[n("v-col",[n("v-range-slider",{staticClass:"playlist-item-trim",attrs:{label:"Trim song",max:e.item.length,min:"0"},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("v-text-field",{attrs:{min:"0",max:Number(e.item.endTime)-1,type:"number",rules:e.rules.startTime,"hide-details":"auto"},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("v-btn",{attrs:{icon:""},on:{click:e.startSegment}},[n("v-icon",[e._v("mdi-format-horizontal-align-left")])],1)]},proxy:!0}]),model:{value:e.item.startTime,callback:function(t){e.$set(e.item,"startTime",e._n(t))},expression:"item.startTime"}})]},proxy:!0},{key:"append",fn:function(){return[n("v-text-field",{attrs:{min:Number(e.item.startTime)+1,max:e.item.length,type:"number",rules:e.rules.endTime,"hide-details":"auto"},scopedSlots:e._u([{key:"append-outer",fn:function(){return[n("v-btn",{attrs:{icon:""},on:{click:e.endSegment}},[n("v-icon",[e._v("mdi-format-horizontal-align-right")])],1)]},proxy:!0}]),model:{value:e.item.endTime,callback:function(t){e.$set(e.item,"endTime",e._n(t))},expression:"item.endTime"}})]},proxy:!0}]),model:{value:e.range,callback:function(t){e.range=t},expression:"range"}})],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.menu=!1}}},[e._v("\n          Cancel\n        ")]),e._v(" "),n("v-btn",{attrs:{color:"primary",loading:e.saving,text:"",disabled:!e.valid},on:{click:function(t){return e.save()}}},[e._v("\n          Save & Close\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;w()(component,{VBtn:k.a,VBtnToggle:V.a,VCard:C.a,VCardActions:C.b,VCardText:C.d,VCol:D.a,VCombobox:A.a,VDialog:$.a,VForm:P.a,VIcon:E.a,VListItem:J.c,VRangeSlider:M.a,VRow:D.d,VSpacer:D.e,VTextField:N.a})},778:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(12),n(11),n(8),n(14),n(13),n(15);var r=n(10),l=n(2),o=(n(4),n(63),n(73),n(382),n(40),n(33),n(34),n(47),n(94),n(82),n(490),n(74)),c=n(316),d=n(0);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f=c.a.extend({name:"v-combobox",props:{delimiters:{type:Array,default:function(){return[]}},returnObject:{type:Boolean,default:!0}},data:function(){return{editingIndex:-1}},computed:{computedCounterValue:function(){return this.multiple?this.selectedItems.length:(this.internalSearch||"").toString().length},hasSlot:function(){return o.a.options.computed.hasSlot.call(this)||this.multiple},isAnyValueAllowed:function(){return!0},menuCanShow:function(){return!!this.isFocused&&(this.hasDisplayedItems||!!this.$slots["no-data"]&&!this.hideNoData)},searchIsDirty:function(){return null!=this.internalSearch}},methods:{onInternalSearchChanged:function(e){if(e&&this.multiple&&this.delimiters.length){var t=this.delimiters.find((function(t){return e.endsWith(t)}));null!=t&&(this.internalSearch=e.slice(0,e.length-t.length),this.updateTags())}this.updateMenuDimensions()},genInput:function(){var input=c.a.options.methods.genInput.call(this);return delete input.data.attrs.name,input.data.on.paste=this.onPaste,input},genChipSelection:function(e,t){var n=this,r=o.a.options.methods.genChipSelection.call(this,e,t);return this.multiple&&(r.componentOptions.listeners=v(v({},r.componentOptions.listeners),{},{dblclick:function(){n.editingIndex=t,n.internalSearch=n.getText(e),n.selectedIndex=-1}})),r},onChipInput:function(e){o.a.options.methods.onChipInput.call(this,e),this.editingIndex=-1},onEnterDown:function(e){e.preventDefault(),this.getMenuIndex()>-1||this.$nextTick(this.updateSelf)},onKeyDown:function(e){var t=e.keyCode;!e.ctrlKey&&[d.A.home,d.A.end].includes(t)||o.a.options.methods.onKeyDown.call(this,e),this.multiple&&t===d.A.left&&0===this.$refs.input.selectionStart?this.updateSelf():t===d.A.enter&&this.onEnterDown(e),this.changeSelectedIndex(t)},onTabDown:function(e){if(this.multiple&&this.internalSearch&&-1===this.getMenuIndex())return e.preventDefault(),e.stopPropagation(),this.updateTags();c.a.options.methods.onTabDown.call(this,e)},selectItem:function(e){this.editingIndex>-1?this.updateEditing():(c.a.options.methods.selectItem.call(this,e),this.internalSearch&&this.multiple&&this.getText(e).toLocaleLowerCase().includes(this.internalSearch.toLocaleLowerCase())&&(this.internalSearch=null))},setSelectedItems:function(){null==this.internalValue||""===this.internalValue?this.selectedItems=[]:this.selectedItems=this.multiple?this.internalValue:[this.internalValue]},setValue:function(e){o.a.options.methods.setValue.call(this,void 0===e?this.internalSearch:e)},updateEditing:function(){var e=this,t=this.internalValue.slice(),n=this.selectedItems.findIndex((function(t){return e.getText(t)===e.internalSearch}));if(n>-1){var l="object"===Object(r.a)(t[n])?Object.assign({},t[n]):t[n];t.splice(n,1),t.push(l)}else t[this.editingIndex]=this.internalSearch;this.setValue(t),this.editingIndex=-1,this.internalSearch=null},updateCombobox:function(){this.searchIsDirty&&(this.internalSearch!==this.getText(this.internalValue)&&this.setValue(),(Boolean(this.$scopedSlots.selection)||this.hasChips)&&(this.internalSearch=null))},updateSelf:function(){this.multiple?this.updateTags():this.updateCombobox()},updateTags:function(){var e=this,t=this.getMenuIndex();if(!(t<0&&!this.searchIsDirty||!this.internalSearch)){if(this.editingIndex>-1)return this.updateEditing();var n=this.selectedItems.findIndex((function(t){return e.internalSearch===e.getText(t)})),l=n>-1&&"object"===Object(r.a)(this.selectedItems[n])?Object.assign({},this.selectedItems[n]):this.internalSearch;if(n>-1){var o=this.internalValue.slice();o.splice(n,1),this.setValue(o)}if(t>-1)return this.internalSearch=null;this.selectItem(l),this.internalSearch=null}},onPaste:function(e){var t;if(this.multiple&&!this.searchIsDirty){var n=null==(t=e.clipboardData)?void 0:t.getData("text/vnd.vuetify.autocomplete.item+plain");n&&-1===this.findExistingIndex(n)&&(e.preventDefault(),o.a.options.methods.selectItem.call(this,n))}},clearableCallback:function(){this.editingIndex=-1,c.a.options.methods.clearableCallback.call(this)}}})}}]);